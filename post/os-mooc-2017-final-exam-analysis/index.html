<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>《操作系统》2017年期末考试分析 | 张慕晖的博客</title>
  
  

  <link rel="alternate" href="/atom.xml" title="张慕晖的博客">

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  
  <!-- link -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.1/katex.min.css">

  
  
  <link rel="undefined" href>
  
  

  


  
  <link rel="stylesheet" href="/style.css">
  

  



  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-119345306-1', 'https://zhanghuimeng.github.io/');
      ga('send', 'pageview');
    </script><!-- hexo-inject:begin --><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css'><!-- hexo-inject:end -->
  
  
</head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading-bar-wrapper">
  <div id="loading-bar" class="pure"></div>
</div>

    <script>setLoadingBarProgress(20)</script>
    <header class="l_header pure">
	<div class="wrapper">
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href="/">
        
          张慕晖的博客
        
      </a>
			<div class="menu">
				<ul class="h-list">
          
  					
  						<li>
								<a id="https:zhanghuimeng.github.io" class="nav flat-box" href="https://zhanghuimeng.github.io/">
									<i class="fas fa-home fa-fw"></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a id="tags" class="nav flat-box" href="/tags/">
									<i class="fas fa-rss fa-fw"></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a id="archives" class="nav flat-box" href="/archives/">
									<i class="fas fa-archive fa-fw"></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a id="categories" class="nav flat-box" href="/categories/">
									<i class="fas fa-users fa-fw"></i>&nbsp;分类
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索">
						<span class="icon"><i class="fas fa-search fa-fw"></i></span>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li>
				
				<li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>

		<div class="nav-sub container container--flex">
			<a class="logo flat-box"></a>
			<ul class="switcher h-list">
				<li class="s-comment"><a class="flat-btn fas fa-comments fa-fw" href="javascript:void(0)"></a></li>
				<li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu">
      <ul>
          
              
                  <li>
										<a id="https:zhanghuimeng.github.io" class="nav flat-box" href="https://zhanghuimeng.github.io/">
											<i class="fas fa-home fa-fw"></i>&nbsp;主页
										</a>
                  </li>
              
                  <li>
										<a id="tags" class="nav flat-box" href="/tags/">
											<i class="fas fa-rss fa-fw"></i>&nbsp;标签
										</a>
                  </li>
              
                  <li>
										<a id="archives" class="nav flat-box" href="/archives/">
											<i class="fas fa-archive fa-fw"></i>&nbsp;归档
										</a>
                  </li>
              
                  <li>
										<a id="categories" class="nav flat-box" href="/categories/">
											<i class="fas fa-users fa-fw"></i>&nbsp;分类
										</a>
                  </li>
              
       
      </ul>
		</nav>
    </header>
	</aside>

    <script>setLoadingBarProgress(40);</script>
    <div class="l_body">
    <div class='container clearfix'>
        <div class='l_main'>
            <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
  
<section class="meta">
  
  
  <div class="meta" id="header-meta">
    
      
          <h1 class="title">《操作系统》2017年期末考试分析</h1>
      
    

    <div class="new-meta-box">
      
        <div class="new-meta-item author">
          <a href="https://zhanghuimeng.github.io">
            <i class="fas fa-user" aria-hidden="true"></i>
            张慕晖
          </a>
        </div>
      
      
        <div class="new-meta-item date">
          <a class="notlink">
            <i class="fas fa-calendar-alt" aria-hidden="true"></i>
            2018-05-22
          </a>
        </div>
      
      
        
      
      
        
          <div class="new-meta-item browse busuanzi">
            <a class="notlink">
              <i class="fas fa-eye" aria-hidden="true"></i>
              <span id="busuanzi_value_page_pv">
                <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
              </span>
            </a>
          </div>
        
      
      
    </div>
    <hr>
  </div>
</section>

    <section class="article typo">
      <div class="article-entry" itemprop="articleBody">
        <p>试题来自<a href="http://os.cs.tsinghua.edu.cn/oscourse/OS2017spring/FinalExam" target="_blank" rel="noopener">2017年春季学期操作系统课期末考试</a>。</p>
<h2 id="填空题30分"><a class="markdownIt-Anchor" href="#填空题30分"></a> 填空题（30分）</h2>
<p>同学们认真完成了从lab0～lab8的所有实验，在实验实践过程中了解和学到了很多知识。下面是他们从最开始到近期的实验心得，请补充完整。</p>
<h3 id="1"><a class="markdownIt-Anchor" href="#1"></a> 1</h3>
<p>lab0: 小强发现完成实验需要在Linux下操作很多命令行工具，于是他认真学习了 lab0中的知识，了解到Linux中在命令行模式下可以通过执行命令(<strong>1.1</strong>)来显示当前目录的文件，如果编写的程序有语法错误，编译器(<strong>1.2</strong>)会报错，根据错误信息，可以修改程序，并可以通过硬件模拟器工具(<strong>1.3</strong>)来执行 ucore 操作系统。</p>
<ol>
<li>ls</li>
<li>gcc</li>
<li>qemu</li>
</ol>
<h3 id="2"><a class="markdownIt-Anchor" href="#2"></a> 2</h3>
<p>lab1: 小晔在bootloader的代码中添加了一条打印语句，但发现编译生成lab项目出错，原来在ucore中只要bootloader的执行代码段+数据段的长度超过了(<strong>2.1</strong>)字节，就无法形成合法有效的bootloader。开始写实验报告时，本来准备提交MS Word文档格式的实验报告，但仔细看过实验报告的提交要求，原来实验指导书中明确要求同学用(<strong>2.2</strong>)文档格式来提交实验报告，小晔之前没学过这个文档格式，不过上网一查，花很短时间就掌握了编写方法，迅速完成了lab1。</p>
<ol>
<li><del>446</del>510</li>
<li>Markdown</li>
</ol>
<hr>
<p>根据<a href="https://zh.wikipedia.org/wiki/%E4%B8%BB%E5%BC%95%E5%AF%BC%E8%AE%B0%E5%BD%95" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/%E4%B8%BB%E5%BC%95%E5%AF%BC%E8%AE%B0%E5%BD%95</a>，主引导扇区中代码区的大小最多为446字节。</p>
<p>2018.5.24 UPD：经过tsz同学的提醒，我查证了一下<code>lab1/tools/sign.c</code>（用于生成磁盘主引导扇区的代码），发现里面是这么写的：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> buf[<span class="number">512</span>];</span><br><span class="line"><span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">FILE *ifp = fopen(argv[<span class="number">1</span>], <span class="string">"rb"</span>);</span><br><span class="line"><span class="keyword">int</span> size = fread(buf, <span class="number">1</span>, st.st_size, ifp);</span><br><span class="line"><span class="keyword">if</span> (size != st.st_size) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"read '%s' error, size is %d.\n"</span>, argv[<span class="number">1</span>], size);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">fclose(ifp);</span><br><span class="line">buf[<span class="number">510</span>] = <span class="number">0x55</span>;</span><br><span class="line">buf[<span class="number">511</span>] = <span class="number">0xAA</span>;</span><br></pre></td></tr></table></figure>
<p>所以虽然维基说的没问题，但是ucore没有管什么“标准MBR分区表规划”，直接把<code>0x55AA</code>之外的510字节全用上了。</p>
<h3 id="3"><a class="markdownIt-Anchor" href="#3"></a> 3</h3>
<p>lab2: 小晖需要了解x86的内存大小与布局，页机制，页表结构等。硬件模拟器提供了 128MB的内存，并设定一个页目录项（PDE）占用(<strong>3.1</strong>)个Byte，一个页表项（PTE）占用(<strong>3.2</strong>)个 Byte。在lab2中可通过(<strong>3.3</strong>)和(<strong>3.4</strong>)两种方式获取系统内存大小，并且由于空闲的RAM空间不连续，所以bootloader简化处理，从物理内存地址(<strong>3.5</strong>)起始填充ucore os kernel的代码段和数据段。在ucore建立完页表并进入页模式后，ucore代码段的起始物理地址对应的虚拟地址为(<strong>3.6</strong>)。</p>
<ol>
<li>4</li>
<li>4</li>
<li>BIOS中断调用</li>
<li>直接探测</li>
<li>0x00100000</li>
<li>0xC0100000</li>
</ol>
<hr>
<p>这块不愧是令人比较困惑。我可能需要复习一下ucore的内存映射方式了。</p>
<h3 id="4"><a class="markdownIt-Anchor" href="#4"></a> 4</h3>
<p>lab3: 小彤发现ucore在完成页机制建立后，内核某内存单元的虚拟地址va为 0xC2345678，且此时硬件模拟器模拟的的cr3寄存器的值为0x221000，则此va对应的页目录表的起始物理地址是(<strong>4.1</strong>)，此va对应的PDE的物理地址是(<strong>4.2</strong>)。如果一个页（4KB/页）被置换到了硬盘某8个连续扇区（0.5KB/扇区），该页对应的页表项（PTE）的最低位–present 位应该为(<strong>4.3</strong>) ，表示虚实地址映射关系不存在，而原来用来表示页帧号的高(<strong>4.4</strong>)位，恰好可以用来表示此页在硬盘上的起始扇区的位置（其从第几个扇区开始）。</p>
<ol>
<li>0x00221000</li>
<li>0x00221C20</li>
<li>0</li>
<li>20</li>
</ol>
<hr>
<p>该va对应的页号和偏移量：</p>
<ul>
<li>0xC2345678 = b11000010001101000101011001111000</li>
<li>页目录号 = b1100001000 = 0x308</li>
<li>页表号 = b1101000101 = 0x345</li>
<li>偏移量 = b011001111000 = 0x678</li>
</ul>
<p>PDE地址 = CR3 + 4*页目录号 = 0x00221000 + 0xC20 = 0x00221C20</p>
<h3 id="5"><a class="markdownIt-Anchor" href="#5"></a> 5</h3>
<p>lab4: 小颖在理解进程管理中，仔细分析了ucore源码中的进程控制块数据结构(<strong>5.1</strong>)，且其中的关键域（也称field，字段）数据结构(<strong>5.2</strong>)用于保存被中断打断的运行现场，关键域数据结构(<strong>5.3</strong>)用于进行进程/线程上下文切换的保存与回复。</p>
<ol>
<li><code>proc_struct</code></li>
<li><code>trap_frame</code></li>
<li><code>context</code></li>
</ol>
<h3 id="6"><a class="markdownIt-Anchor" href="#6"></a> 6</h3>
<p>lab5: 小辰对用户进程的创建有了更深入的了解：用户进程在用户态下执行时，CS 段寄存器最低第两位的值为(<strong>6.1</strong>)。当ucore os kernel建立完毕第一个用户进程的执行环境后，通过执行x86机器指令(<strong>6.2</strong>)后，将从内核态切换到用户态，且将从用户进程的第一条指令处继续执行。当用户进程执行sys_exit系统调用后，ucore会回收当前进程所占的大部分资源，并把当前进程的状态设置为(<strong>6.3</strong>)。</p>
<ol>
<li>3</li>
<li>IRET</li>
<li>ZOMBIE</li>
</ol>
<hr>
<p>用户态下，CS段的RPL的值应该为3.</p>
<h3 id="7"><a class="markdownIt-Anchor" href="#7"></a> 7</h3>
<p>lab6: 小磊通过阅读代码，了解了ucore的调度框架和RR调度算法等，体会到调度本质上体现了对(<strong>7.1</strong>)资源的抢占，操作系统通过(<strong>7.2</strong>)来避免用户态进程长期运行，并获得控制权。</p>
<ol>
<li>处理机执行能力（时间片？）</li>
<li>时钟中断</li>
</ol>
<hr>
<p>之所以1的回答是“处理机执行能力”，主要是因为第15讲里说，“处理机调度是管理处理机执行能力的资源”。我觉得答CPU之类的也可以。</p>
<h3 id="8"><a class="markdownIt-Anchor" href="#8"></a> 8</h3>
<p>lab7: 小航发现课本中阐述的同步互斥原理对实现细节简化了很多。在ucore中，通过利用x86机器指令(<strong>8.1</strong>)简洁地实现了入临界区代码，通过利用x86指令(<strong>8.2</strong>)简洁地实现了出临界区代码。通过分析ucore中管程的数据结构，可知道ucore中的管程机制是基于(<strong>8.3</strong>)机制和(<strong>8.4</strong>)机制来实现的。</p>
<ol>
<li>CLI</li>
<li>STI</li>
<li>信号量</li>
<li>等待队列</li>
</ol>
<hr>
<p>有时候分不清楚CLI和STI。事实上，CLI的意思是“Clean IF”，即将IF置零，屏蔽中断；STI的意思是“Set IF”，即将IF置1，不屏蔽中断。姑且这样记一下吧。</p>
<h3 id="9"><a class="markdownIt-Anchor" href="#9"></a> 9</h3>
<p>lab8: 小行了解到ucore中的文件系统架构包含四类主要的数据结构， (<strong>9.1</strong>)：它主要从文件系统的全局角度描述特定文件系统的全局信息。 (<strong>9.2</strong>)：它主要从文件系统中单个文件的角度描述了文件的各种属性和数据所在位置。 (<strong>9.3</strong>)：它主要从文件系统的文件路径的角度描述了文件路径中的特定目录。 (<strong>9.4</strong>)： 它主要从进程的角度描述了一个进程在访问文件时需要了解的文件标识，文件读写的位置，文件引用情况等信息。</p>
<ol>
<li>超级块（SuperBlock）</li>
<li>索引节点（inode）</li>
<li>目录项（dentry）</li>
<li>文件（file）</li>
</ol>
<hr>
<p>Lab8中的各种结构好多，完全不知道该回答什么啊。</p>
<p>2018.5.24 UPD：今天tsz同学提醒我，这个问题是实验指导书中的原话<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>：</p>
<blockquote>
<p>从ucore操作系统不同的角度来看，ucore中的文件系统架构包含四类主要的数据结构，它们分别是：</p>
<ul>
<li>超级块（SuperBlock）：它主要从文件系统的全局角度描述特定文件系统的全局信息。它的作用范围是整个OS空间。</li>
<li>索引节点（inode）：它主要从文件系统的单个文件的角度描述了文件的各种属性和数据所在位置。它的作用范围是整个OS空间。</li>
<li>目录项（dentry）：它主要从文件系统的文件路径的角度描述了文件路径中的特定目录。它的作用范围是整个OS空间。</li>
<li>文件（file）：它主要从进程的角度描述了一个进程在访问文件时需要了解的文件标识，文件读写的位置，文件引用情况等信息。它的作用范围是某一具体进程。</li>
</ul>
</blockquote>
<h2 id="问答题70分"><a class="markdownIt-Anchor" href="#问答题70分"></a> 问答题（70分）</h2>
<h3 id="10-同步互斥10分"><a class="markdownIt-Anchor" href="#10-同步互斥10分"></a> 10. 同步互斥（10分）</h3>
<p>下面列出的n个线程互斥机制的伪代码实现有误，请指出错误处，给出错误原因分析，描述错误会带来的后果（即给出反例：无法正确执行n线程有效互斥运行行为的执行序列）。最后请修正错误，使得伪代码正确。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">INITIALIZATION:</span><br><span class="line">    shared <span class="keyword">int</span> num[n];</span><br><span class="line">    <span class="keyword">for</span> (j=<span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">        num[j] = j;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">-------------------------------</span><br><span class="line">ENTRY PROTOCOL (for Thread i):</span><br><span class="line">    num[i] = MAX(num[<span class="number">0</span>], ..., num[n<span class="number">-1</span>]) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (j=<span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((num[j] &gt; <span class="number">0</span>) &amp;&amp; ((num[j] &lt; num[i]) || (num[j] == num[i]) &amp;&amp; (j &lt; i))) &#123;</span><br><span class="line">            <span class="keyword">while</span> (num[j] &gt; <span class="number">0</span>) &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">-----------------------------</span><br><span class="line">EXIT PROTOCOL (for Thread i):</span><br><span class="line">    num[i] = <span class="number">0</span>;</span><br><span class="line">-----------------------------</span><br></pre></td></tr></table></figure>
<hr>
<p>这道题和<a href="/post/os-mooc-2016-final-exam-analysis">2016年期末</a>的26.2题几乎一模一样，唯一的区别是此处初始化时将<code>num[j]</code>初始化为<code>j</code>，而不是<code>0</code>。这一点显然违背了“空闲则入”的原则：假如线程<code>n-1</code>想要进入临界区，它必须等待编号比它小的线程全部进入过临界区，这可能会导致饥饿，所以还是应该初始化为<code>0</code>。因此，在线程i执行ENTRY PROTOCOL之前，<code>num[i]</code>必然为0。</p>
<p>在我的理解中，共享数组<code>num[n]</code>有两个含义：</p>
<ul>
<li><code>num[i] &gt; 0</code>表示线程i正在等待或已经进入临界区；<code>num[i] = 0</code>表示线程i离开了临界区且并没有等待进入临界区</li>
<li><code>num[i] &gt; 0</code>时，表示线程i等待的优先级，数字越大，优先级越低</li>
</ul>
<p>基于以上的讨论，我认为，<code>num</code>数组中非0的值必须是互不相同的。从ENTRY PROTOCOL的实现可以看出，如果<code>num[i] = MAX(num[0], ..., num[n-1]) + 1</code>这一操作是原子的，则上述结论显然；如果这一操作不是原子的，则可能会出现两个线程i和j的优先级相同的情况。不妨设i&lt;j，且其他线程的<code>num</code>均为0。假如线程i在<code>num[i]</code>没有完成赋值之前被打断，切换到线程j，则j会发现其他线程的<code>num</code>均为0，于是进入临界区。之后切换回线程i，i检查时虽然发现<code>num[i] == num[j]</code>，但由于<code>i &lt; j</code>，于是也进入临界区，破坏了“忙则等待”要求。</p>
<p>假如能够保证<code>num[i] = MAX(num[0], ..., num[n-1]) + 1</code>这一操作是原子的，则上述实现是正确的，且可以删去<code>(num[j] == num[i]) &amp;&amp; (j &lt; i)</code>这一判断条件。在检查条件过程中被打断并不会影响算法的正确性，因为，即使已经被检查过的线程的优先级发生了变化，它也只可能变成0（它不再进入临界区，没有影响）或者优先级比当前线程变得更大（它退出临界区之后又想重新进入，需要取max），不需要重新进行等待。</p>
<p>但是现在的问题是怎么实现取max操作的原子性。如果直接加个互斥锁，不免太过智熄。（那我们还实现软件方法的N线程互斥干啥……）那就直接加个共享变量作为自旋锁好了，而且需要保证赋值过程是原子的。……虽然这样也完全没有意义，难道要直接改成Eisenberg &amp; McGuire算法么……</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">INITIALIZATION:</span><br><span class="line">    shared <span class="keyword">int</span> num[n];</span><br><span class="line">    shared <span class="keyword">bool</span> choose[n];</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">        num[j] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mutex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">-------------------------------</span><br><span class="line">ENTRY PROTOCOL (for Thread i):</span><br><span class="line">    num[i] = MAX(num[<span class="number">0</span>], ..., num[n<span class="number">-1</span>]) + <span class="number">1</span>;  <span class="comment">// do this atomically</span></span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((num[j] &gt; <span class="number">0</span>) &amp;&amp; ((num[j] &lt; num[i]) || (num[j] == num[i]) &amp;&amp; (j &lt; i))) &#123;</span><br><span class="line">            <span class="keyword">while</span> (num[j] &gt; <span class="number">0</span>) &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">-----------------------------</span><br><span class="line">EXIT PROTOCOL (for Thread i):</span><br><span class="line">    num[i] = <span class="number">0</span>;</span><br><span class="line">-----------------------------</span><br></pre></td></tr></table></figure>
<p>2018.5.24 UPD：tsz同学给出了一种想法，我还没有仔细思考过它的正确性：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------</span><br><span class="line">ENTRY PROTOCOL (for Thread i):</span><br><span class="line">    num[i] = MAX(num[<span class="number">0</span>], ..., num[n<span class="number">-1</span>]) + <span class="number">1</span>;  <span class="comment">// do this atomically</span></span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((num[j] &gt; <span class="number">0</span>) &amp;&amp; ((num[j] &lt; num[i]) || (num[j] == num[i]) &amp;&amp; (j &lt; i)) || flag[j] &amp;&amp; (j &lt; i)) &#123;</span><br><span class="line">            <span class="keyword">while</span> (num[j] &gt; <span class="number">0</span>) &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="11-管程10分"><a class="markdownIt-Anchor" href="#11-管程10分"></a> 11. 管程（10分）</h3>
<p>下面是一类管程机制的实现伪代码。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">IMPLEMENTATION:</span><br><span class="line">monitor mt &#123;</span><br><span class="line">    -----variable in monitor-----------</span><br><span class="line">    semaphore mutex;</span><br><span class="line">    semaphore next;</span><br><span class="line">    <span class="keyword">int</span> next_count;</span><br><span class="line">    condvar &#123;<span class="keyword">int</span> count, sempahore sem&#125; cv[N];</span><br><span class="line">    other shared variables in mt;</span><br><span class="line">    ----condvar wait implementation----</span><br><span class="line">    cond_wait (cv) &#123;</span><br><span class="line">        cv.count ++;</span><br><span class="line">        <span class="keyword">if</span>(mt.next_count&gt;<span class="number">0</span>)</span><br><span class="line">            V(mt.next);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            V(mt.mutex);</span><br><span class="line">        P(cv.sem);</span><br><span class="line">        cv.count --;</span><br><span class="line">    &#125;</span><br><span class="line">    ----condvar signal implementation----</span><br><span class="line">    cond_signal(cv) &#123;</span><br><span class="line">        <span class="keyword">if</span>(cv.count&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            mt.next_count ++;</span><br><span class="line">            V(cv.sem);</span><br><span class="line">            P(mt.next);</span><br><span class="line">            mt.next_count--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ----routine examples in monitor----</span><br><span class="line">    Routines_in_mt () &#123;</span><br><span class="line">        P(mt.mutex);</span><br><span class="line">        real bodies of routines, may access shared variables, call cond_wait OR cond_signal</span><br><span class="line">        <span class="keyword">if</span>(next_count&gt;<span class="number">0</span>)</span><br><span class="line">        V(mt.next);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        V(mt.mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上述伪码中，如果有3个线程a,b,c需要访问管程，并会使用管程中的2个条件变量 cv[0],cv[1]。请问cv[i]-&gt;count含义是什么？cv[i]-&gt;count是否可能&lt;0, 是否可能&gt;1？请说明原因，并给出相应的3个线程同步互斥执行实例和简要解释。请问 mt-&gt;next_count含义是什么？mt-&gt;next_count是否可能&lt;0, 是否可能&gt;1？请说明原因，并给出相应的3个线程同步互斥执行过程实例和简要解释。</p>
<hr>
<p>这道题和<a href="/post/os-mooc-2016-final-exam-analysis">2016年期末</a>的27题一模一样，连笔误都一样，不解释了。</p>
<h3 id="12-理发师问题20分"><a class="markdownIt-Anchor" href="#12-理发师问题20分"></a> 12. 理发师问题（20分）</h3>
<p>理发店里有m位理发师、m把理发椅和n把供等候理发的顾客坐的椅子。理发师为一位顾客理完发后，查看是否有顾客等待，如有则唤醒一位为其理发；如果没有顾客，理发师便在理发椅上睡觉。一个新顾客到来时，首先查看理发师在干什么，如果理发师在理发椅上睡觉，他必须叫醒理发师，然后理发师理发，顾客被理发；如果理发师正在理发，则新顾客会在有空椅子可坐时坐下来等待，否则就会离开。请用信号量机制实现理发师问题的正确且高效的同步与互斥活动：请说明所定义的信号量的含义和初始值，描述需要进行互斥处理的各种行为，描述需要进行同步处理的各种行为；要求用类C语言的伪代码实现，并给出必要的简明代码注释。</p>
<hr>
<p>感觉这个的初步实现到处都是，比如<a href="http://whatbeg.com/2017/03/06/semaphore.html#%E9%97%AE%E9%A2%988%EF%BC%9A%E7%90%86%E5%8F%91%E5%B8%88%E9%97%AE%E9%A2%98" target="_blank" rel="noopener">http://whatbeg.com/2017/03/06/semaphore.html#问题8：理发师问题</a>。但是我现在都要困死了，实在思考不了这种高思维含量的东西。</p>
<p>2018.5.24 UPD：今天tsz同学给出了一种做法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Customer</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Customer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (waitCnt &gt; n)</span><br><span class="line">        <span class="keyword">return</span> FAIL;</span><br><span class="line">    waitLock.P();</span><br><span class="line">    waitCnt++;</span><br><span class="line">    waitLock.V();</span><br><span class="line">    waitList.P();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// haircut</span></span><br><span class="line"></span><br><span class="line">    waitLock.P();</span><br><span class="line">    waitCnt--;</span><br><span class="line">    waitLock.V();</span><br><span class="line">    <span class="keyword">return</span> SUCCEED;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Barber</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Barber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (waitCnt == <span class="number">0</span>);</span><br><span class="line">        waitList.V();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但我还没有仔细想过这个做法的正确性。</p>
<h3 id="13-spn算法8分"><a class="markdownIt-Anchor" href="#13-spn算法8分"></a> 13. SPN算法（8分）</h3>
<p>请给出平均周转时间的定义，请给出短进程优先算法的描述，请证明：短进程优先算法具有最小平均周转时间。</p>
<hr>
<ul>
<li>周转时间：进程从初始化到结束（包括等待）的总时间</li>
<li>平均周转时间：所有进程周转时间的平均数</li>
<li>短进程优先（SPN）算法：总是选择就绪队列中执行时间最短的进程占用CPU进入运行状态</li>
</ul>
<p>证明：<br>
假设就绪队列中共有N个进程，它们的执行时间分别为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>t</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">t_1, t_2, ..., t_N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。不妨设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>t</mi><mn>2</mn></msub><mo>≤</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>≤</mo><msub><mi>t</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">t_1 \leq t_2 \leq ... \leq t_N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。则SPN算法的总周转时间为</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><mi>T</mi><mo>=</mo><msub><mi>t</mi><mn>1</mn></msub><mo>+</mo><mo>(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>+</mo><msub><mi>t</mi><mn>2</mn></msub><mo>)</mo><mo>+</mo><mo>(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>+</mo><msub><mi>t</mi><mn>2</mn></msub><mo>+</mo><msub><mi>t</mi><mn>3</mn></msub><mo>)</mo><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mo>(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>+</mo><msub><mi>t</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>t</mi><mi>N</mi></msub><mo>)</mo><mo>=</mo><mi>N</mi><mo>∗</mo><msub><mi>t</mi><mn>1</mn></msub><mo>+</mo><mo>(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>t</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>t</mi><mi>N</mi></msub></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{aligned}
T = t_1 + (t_1 + t_2) + (t_1 + t_2 + t_3) + ... + (t_1 + t_2 + ... + t_N) = N * t_1 + (N-1) * t_2 + ... + t_N
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8500000000000001em;"></span><span class="strut bottom" style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.010000000000000009em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></span>
<p>假设我们交换了第i和j（i&lt;j）个进程的执行顺序，则此时，总周转时间会变为</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>T</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>=</mo><mi>N</mi><mo>∗</mo><msub><mi>t</mi><mn>1</mn></msub><mo>+</mo><mo>(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>t</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mo>(</mo><mi>N</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>t</mi><mi>j</mi></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mo>(</mo><mi>N</mi><mo>−</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>t</mi><mi>i</mi></msub><mo>+</mo><msub><mi>t</mi><mi>N</mi></msub></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{aligned}
T&#x27; = N * t_1 + (N-1) * t_2 + ... + (N-i+1) * t_j + ... + (N-j+1) * t_i + t_N
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8500000000000001em;"></span><span class="strut bottom" style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.010000000000000009em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">−</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">−</span><span class="mord mathit">i</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><msup><mi>T</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup><mo>−</mo><mi>T</mi><mo>=</mo><mo>(</mo><mi>N</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>t</mi><mi>j</mi></msub><mo>+</mo><mo>(</mo><mi>N</mi><mo>−</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><mo>(</mo><mi>N</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><mo>(</mo><mi>N</mi><mo>−</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>t</mi><mi>j</mi></msub><mo>=</mo><mo>(</mo><mi>i</mi><mo>−</mo><mi>j</mi><mo>)</mo><mo>∗</mo><mo>(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mi>j</mi></msub><mo>)</mo><mo>&gt;</mo><mo>=</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{aligned}
T&#x27; - T = (N-i+1) * t_j + (N-j+1) * t_i - (N-i+1) * t_i - (N-j+1) * t_j = (i-j) * (t_i - t_j) &gt;= 0
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8500000000000001em;"></span><span class="strut bottom" style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.010000000000000009em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">−</span><span class="mord mathit">i</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">−</span><span class="mord mathit">i</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mbin">∗</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">t</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">&gt;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></span>
<p>由于任何进程执行顺序都可以通过对顺序排列的进程进行若干次交换而得到，上述证明表明，任何其他执行顺序得到的平均周转时间都不可能比SPN算法更优。因此，SPN算法具有最小平均周转时间。</p>
<h3 id="14-lfu算法14分"><a class="markdownIt-Anchor" href="#14-lfu算法14分"></a> 14. LFU算法（14分）</h3>
<p>LFU是最近最不常用页面置换算法(Least Frequently Used)，小白听到两个LFU定义的说法，有些糊涂：</p>
<ol>
<li>采用LFU算法的OS在碰到进程访问的物理内存不够时，换出进程执行期内被访问次数最少的内存页，当此页被换出后，其访问次数n会被记录下来，当此页被再次访问并被换入时，此页的访问次数为n+1。</li>
<li>采用LFU算法的OS在碰到进程访问的物理内存不够时，换出进程执行期内被访问次数最少的内存页，当此页被换出后，其访问次数清零，当此页被再次访问并被换入时，此页的访问次数为1。</li>
</ol>
<p>请问你认为那种LFU的定义是正确的？请分别回答第一种/第二种LFU定义是否有Belady 异常现象。如没有，请给出证明，如有，请给出会引起Belady异常现象的的页数/页帧数设置以及访问序列。</p>
<hr>
<p>呃，我不会啊……但我认为做法1显然不太可取。LFU算法比较严重的一个问题是计数器的劣化（这个名字是我随便起的）：之前被大量访问，但以后不再被使用的页不容易被换出。为了解决这个问题，计数器可以定期右移之类的。现在页计数器根本不会减小，怕不是要出事……不过被换出的页大概被访问次数是很少的，所以我也不知道1有什么用。</p>
<p>2大概有Belady现象。1不知道。看来需要仔细研究一下Piazza上给出的例子了。</p>
<p>2018.5.24 UPD：<br>
今天zp同学提醒我，<a href="https://piazza.com/class/i5j09fnsl7k5x0?cid=1031" target="_blank" rel="noopener">Piazza</a>上有一个帖子讨论了这一内容。我们一般说的LFU的定义是第2种，而非第1种；该帖子指出，第1种定义下LFU不会出现Belady问题（虽然没有给出证明），而第2种定义下LFU会出现Belady问题，并举出了例子。</p>
<p>令访问序列为[0 0 1 1 1 2 2 0 0 2 2 3 1 3 1 3 1 3 1 3 1 3 1 … （之后无限循环3 1 3 1）]。在有2个物理页帧的情况下，访问过程是这样的（括号里是访问计数）：</p>
<table>
<thead>
<tr>
<th>访存</th>
<th>物理页a</th>
<th>物理页b</th>
<th>缺页</th>
<th>换出</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0(1)</td>
<td>-</td>
<td>0</td>
<td>-</td>
</tr>
<tr>
<td>0</td>
<td>0(2)</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>0(2)</td>
<td>1(1)</td>
<td>1</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>0(2)</td>
<td>1(2)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>0(2)</td>
<td>1(3)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>2</td>
<td>2(1)</td>
<td>1(3)</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>2(2)</td>
<td>1(3)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>0</td>
<td>0(1)</td>
<td>1(3)</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>0</td>
<td>0(2)</td>
<td>1(3)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>2</td>
<td>2(1)</td>
<td>1(3)</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>2(2)</td>
<td>1(3)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>3</td>
<td>3(1)</td>
<td>1(3)</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>3(1)</td>
<td>1(4)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>3</td>
<td>3(2)</td>
<td>1(4)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>3(2)</td>
<td>1(5)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>3</td>
<td>3(3)</td>
<td>1(5)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>3(3)</td>
<td>1(6)</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>可以看出，一共只会缺页6次，在之后的循环过程中不会缺页。</p>
<p>但是，如果物理页帧数量增加到3，访问过程会变成这样：</p>
<table>
<thead>
<tr>
<th>访存</th>
<th>物理页a</th>
<th>物理页b</th>
<th>物理页c</th>
<th>缺页</th>
<th>换出</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0(1)</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>-</td>
</tr>
<tr>
<td>0</td>
<td>0(2)</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>0(2)</td>
<td>1(1)</td>
<td>-</td>
<td>1</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>0(2)</td>
<td>1(2)</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>0(2)</td>
<td>1(3)</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>2</td>
<td>0(2)</td>
<td>1(3)</td>
<td>2(1)</td>
<td>2</td>
<td>-</td>
</tr>
<tr>
<td>2</td>
<td>0(2)</td>
<td>1(3)</td>
<td>2(2)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>0</td>
<td>0(3)</td>
<td>1(3)</td>
<td>2(2)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>0</td>
<td>0(4)</td>
<td>1(3)</td>
<td>2(2)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>2</td>
<td>0(4)</td>
<td>1(3)</td>
<td>2(4)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>2</td>
<td>0(4)</td>
<td>1(3)</td>
<td>2(4)</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>3</td>
<td>0(4)</td>
<td>3(1)</td>
<td>2(4)</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0(4)</td>
<td>1(1)</td>
<td>2(4)</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>0(4)</td>
<td>3(1)</td>
<td>2(4)</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0(4)</td>
<td>1(1)</td>
<td>2(4)</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>0(4)</td>
<td>3(1)</td>
<td>2(4)</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0(4)</td>
<td>1(1)</td>
<td>2(4)</td>
<td>1</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>可以看出，现在已经缺页9次了，而且之后每访问一次都会发生缺页。</p>
<p>上述讨论可以说明一般的LFU算法有Belady问题。那么为什么修改过的（有记忆的）LFU算法可以没有Belady问题呢？<a href="https://stackoverflow.com/questions/21289990/does-the-lfu-page-reclamation-algorithm-suffer-from-beladys-anomaly" target="_blank" rel="noopener">stackoverflow</a>上是这么说的：</p>
<blockquote>
<p><a href="http://www.eecs.berkeley.edu/Pubs/TechRpts/1987/CSD-87-358.pdf" target="_blank" rel="noopener">http://www.eecs.berkeley.edu/Pubs/TechRpts/1987/CSD-87-358.pdf</a> section 1.3 defines the stack algorithm and finishes by working through an example of this for LFU. Basically you can maintain a stack as you follow through a trace of memory fetches such that the top i entries of the stack are the entries that will be held in memory if you have capacity for i entries in your memory. Since you can maintain such a stack a larger memory must always hold all of the entries kept in core for any smaller memory and so Belady’s anomaly is not possible.<br>
Of course this assumes an exact implementation of LFU with counters of infinite capacity.</p>
</blockquote>
<p>上面的内容大概是说，修改过的LFU算法实际上相当于维护了一个很大的访问次数栈，栈中的页按访问次数排序，顶端的N个页驻留在内存中。因此，它本质上是一种栈算法，所以不存在Belady问题。具体证明我现在没时间去看了，欢迎大家自己去看论文。</p>
<h3 id="15-小明文件系统8分"><a class="markdownIt-Anchor" href="#15-小明文件系统8分"></a> 15. 小明文件系统（8分）</h3>
<p>小明为更好理解lab8，设计了一个简化文件系统Xiao Miang File System, 简称 xmfs。</p>
<p><strong>xmfs的系统调用接口包括：</strong></p>
<ul>
<li>mkdir() - 创建一个新目录</li>
<li>creat() - 创建一个空文件</li>
<li>open(), write(), close() - 打开文件，写文件，关闭文件</li>
<li>link() - 对文件创建一个硬链接（ hard link）</li>
<li>unlink() - 对文件取消一个硬链接 (如果文件的链接数为0，则删除文件）</li>
<li><strong>注意</strong>：通过 write()对文件写一个数据buffer时，常规文件的最大size是一个 data block，所以第二次写（写文件的语义是在上次写的位置后再写一个data block）会报错（文件大小满了）。如果data block 也满了，也会报错。</li>
</ul>
<p><strong>xmfs在硬盘上的总体组织结构如下：</strong></p>
<ul>
<li>superblock：记录可用inode数量，可用data block数量</li>
<li>inode bitmap：已用/空闲inode的分配图（基于bitmap）</li>
<li>inodes：inode的存储区域</li>
<li>data bitmap：data block的分配图（基于bitmap）</li>
<li>data：data block的存储区域</li>
</ul>
<p><strong>xmfs的关键数据结构–inode数据结构如下：</strong></p>
<ul>
<li>inode：包含3个fields（file type，data block addr of file content，reference count）,用list表示：</li>
<li>file type: f -&gt; 常规文件： regular file, d -&gt; 目录文件： directory</li>
<li>data block addr of file content: -1 -&gt; file is empty</li>
<li>reference count: file/directory 的引用计数，注意directory的引用计数是指在此目录中的inode的个数</li>
<li><strong>注意</strong>：比如，刚创建的一个空文件inode：[f a:-1 r:1]，一个有1个硬链接的文件inode：[f a:10 r:2]</li>
</ul>
<p><strong>xmfs的关键数据结构–数据块（data block）结构如下：</strong></p>
<ul>
<li>一般文件的内容表示：只是包含单个字符的 list，即占一个 data block，比如[‘a’], [‘b’] …</li>
<li>目录的内容表示：多个两元组（name, inode_number）形成的list，比如，根目录 [(.,0) (…,0)]，或者包含了一个’f’文件的根目录[(.,0) (…,0) (f,1)]。</li>
<li><strong>注意</strong>：一个目录的目录项的个数是有限的。block.maxUsed = 32</li>
<li><strong>注意</strong>：data block 的个数是有限的,为fs.numData</li>
<li><strong>注意</strong>：inode 的个数是有限的,为fs.numInodes</li>
</ul>
<p><strong>完整xmfs文件系统的参考实例：</strong></p>
<p>fs.ibitmap: inode bitmap 11110000<br>
fs.inodes: [d a:0 r:5] [f a:1 r:1] [f a:-1 r:1] [d a:2 r:2] [] …<br>
fs.dbitmap: data bitmap 11100000<br>
fs.data: [(.,0) (…,0) (y,1) (z,2) (x,3)] [u] [(.,3) (…,0)] [] …</p>
<p><strong>对上述xmfs参考实例的解释</strong>：有8个inode空间,8个data blocks.其中，根目录包含5个目录项，“.”，“…”，“y”，“z”，“x”。而“y”是常规文件,并有文件内容，包含一个data block，文件内容为“u”。“z”是一个空的常规文件。“x”是一个目录文件，是空目录。</p>
<p><strong>如果xmfs初始状态为：</strong><br>
<em>inode bitmap 10000000</em><br>
inodes [d a:0 r:2] [] [] [] [] [] [] []<br>
data bitmap 10000000<br>
data [(.,0) (…,0)] [] [] [] [] [] [] []</p>
<p>在执行了系统调用mkdir(&quot;/t&quot;)后，<strong>xmfs的当前状态为：</strong><br>
<em>inode bitmap 11000000</em><br>
inodes [d a:0 r:3] [d a:1 r:2] [] [] [] [] [] []<br>
data bitmap 11000000<br>
data [(.,0) (…,0) (t,1)] [(.,1) (…,0)] [] [] [] [] [] []</p>
<p>请问接下来的4个状态变化所对应系统调用是什么？ 要求回答格式象上面“mkdir(&quot;/t&quot;)”一样。</p>
<p>（1）<br>
<em>inode bitmap 11100000</em><br>
inodes [d a:0 r:4] [d a:1 r:2] [f a:-1 r:1] [] [] [] [] []<br>
data bitmap 11000000<br>
data [(.,0) (…,0) (t,1) (y,2)] [(.,1) (…,0)] [] [] [] [] [] []</p>
<p>（2）<br>
<em>inode bitmap 11100000</em><br>
inodes [d a:0 r:4] [d a:1 r:3] [f a:-1 r:2] [] [] [] [] []<br>
data bitmap 11000000<br>
data [(.,0) (…,0) (t,1) (y,2)] [(.,1) (…,0) (c,2)] [] [] [] [] [] []</p>
<p>（3）<br>
<em>inode bitmap 11100000</em><br>
inodes [d a:0 r:4] [d a:1 r:3] [f a:2 r:2] [] [] [] [] []<br>
data bitmap 11100000<br>
data [(.,0) (…,0) (t,1) (y,2)] [(.,1) (…,0) (c,2)] [o] [] [] [] [] []</p>
<p>（4）<br>
<em>inode bitmap 11110000</em><br>
inodes [d a:0 r:5] [d a:1 r:3] [f a:2 r:2] [d a:3 r:2] [] [] [] []<br>
data bitmap 11110000<br>
data [(.,0) (…,0) (t,1) (y,2) (v,3)] [(.,1) (…,0) (c,2)] [o] [(.,3) (…,0)] [] [] [] []</p>
<hr>
<ol>
<li>create(&quot;/y&quot;)</li>
<li>link(&quot;/y&quot;, “/t/c”)</li>
<li>fd=open(&quot;/y&quot;), write(fd), close(fd)</li>
<li>mkdir(&quot;/v&quot;)</li>
</ol>
<p>这道题的形式非常类似于<a href="/post/os-mooc-final-exam-analysis">MOOC上的期末试题</a>中的第20题。</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://objectkuan.gitbooks.io/ucore-docs/lab8/lab8_3_1_ucore_fs_introduction.html" target="_blank" rel="noopener">uCore Lab Documents - ucore 文件系统总体介绍 - ucore文件系统总体结构</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>

      </div>
        
          <section class="meta" id="footer-meta">
            <hr>
            <div class="new-meta-box">
              
                <div class="new-meta-item date" itemprop="dateUpdated" datetime="2018-12-27T11:07:00+00:00">
                  <a class="notlink">
                    <i class="fas fa-pencil-alt" aria-hidden="true"></i>
                    2018-12-27
                  </a>
                </div>
              
              
                
                <div class="new-meta-item meta-tags"><a class="tag" href="/tags/OS/"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;OS</a></div>
              
              
            </div>
          </section>
        

        
            <div class="prev-next">
                
                    <section class="prev">
                        <span class="art-item-left">
                            <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                            <h4>
                                <a href="/post/os-mooc-2015-final-exam-analysis/" rel="prev" title="《操作系统》2015年期末考试分析">
                                  
                                      《操作系统》2015年期末考试分析
                                  
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/OS/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>OS</a>
                                </h6>
                            
                        </span>
                    </section>
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/post/os-mooc-final-exam-analysis/" rel="prev" title="《操作系统》MOOC期末考试题分析">
                                    
                                        《操作系统》MOOC期末考试题分析
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/OS/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>OS</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        

    </section>

</article>

<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->

    <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX","TeX"],
      linebreaks: { automatic:true },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: { autoNumber: "AMS" },
      noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
      Macros: { href: "{}" }
    },
    messageStyle: "none"
  });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += (all[i].SourceElement().parentNode.className ? ' ' : '') + 'has-jax';
    }
    console.log("mathjax did loaded!");
  });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<br>

<!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">
      
      
        <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
        
        
          <section id="comments">
            <div id="lv-container" data-id="city" data-uid="MTAyMC80MjgyNi8xOTM3Mw==">
              <noscript>⚠️  无法加载评论系统，请确保您的网络能够正常访问</noscript>
            </div>
          </section>
        
        
      
    </section>
  </article>



<script>
    window.subData = {
        title: '《操作系统》2017年期末考试分析',
        tools: true
    }
</script>


        </div>
        <aside class='l_side'>
            
  
  
    
      
      
        <section class="author">
  <div class="content pure">
    
    
    
      <div class="social-wrapper">
        
          
            <a href="mailto:zhanghuimeng1997@gmail.com" class="social flat-btn" target="_blank" rel="external"><i class="social fas fa-envelope" aria-hidden="true"></i></a>
          
        
          
            <a href="https://github.com/zhanghuimeng" class="social flat-btn" target="_blank" rel="external"><i class="social fab fa-github" aria-hidden="true"></i></a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=261028414" class="social flat-btn" target="_blank" rel="external"><i class="social fas fa-music" aria-hidden="true"></i></a>
          
        
      </div>
    
  </div>
</section>

      
    
  
    
      
      
        
  <section class="toc-wrapper">
    
<header class="pure">
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;文章目录</div>
  
    <div class="wrapper"><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div>
  
</header>

    <div class="content pure">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#填空题30分"><span class="toc-text"> 填空题（30分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-text"> 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-text"> 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-text"> 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4"><span class="toc-text"> 4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5"><span class="toc-text"> 5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6"><span class="toc-text"> 6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7"><span class="toc-text"> 7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8"><span class="toc-text"> 8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9"><span class="toc-text"> 9</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问答题70分"><span class="toc-text"> 问答题（70分）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-同步互斥10分"><span class="toc-text"> 10. 同步互斥（10分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-管程10分"><span class="toc-text"> 11. 管程（10分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-理发师问题20分"><span class="toc-text"> 12. 理发师问题（20分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-spn算法8分"><span class="toc-text"> 13. SPN算法（8分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-lfu算法14分"><span class="toc-text"> 14. LFU算法（14分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-小明文件系统8分"><span class="toc-text"> 15. 小明文件系统（8分）</span></a></li></ol></li></ol>
    </div>
  </section>


      
    
  
    
      
      
        
  <section class="category">
    
<header class="pure">
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;所有分类</div>
  
</header>

    <div class="content pure">
      <ul class="entry">
        
          <li><a class="flat-box" title="/categories/Codeforces/" href="/categories/Codeforces/"><div class="name">Codeforces</div><div class="badge">(3)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Leetcode/" href="/categories/Leetcode/"><div class="name">Leetcode</div><div class="badge">(9)</div></a></li>
        
          <li><a class="flat-box" title="/categories/USACO/" href="/categories/USACO/"><div class="name">USACO</div><div class="badge">(1)</div></a></li>
        
      </ul>
    </div>
  </section>


      
    
  
    
      
      
        
  <section class="tagcloud">
    
<header class="pure">
  <div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
</header>

    <div class="content pure">
      <a href="/tags/A-Munday/" style="font-size: 14px; color: #999">A.Munday</a> <a href="/tags/Blogging/" style="font-size: 14px; color: #999">Blogging</a> <a href="/tags/C-Marlowe/" style="font-size: 14px; color: #999">C.Marlowe</a> <a href="/tags/CSP/" style="font-size: 15.11px; color: #919191">CSP</a> <a href="/tags/Codeforces/" style="font-size: 19.56px; color: #737373">Codeforces</a> <a href="/tags/Codeforces-Contest/" style="font-size: 19.19px; color: #767676">Codeforces Contest</a> <a href="/tags/Counseling/" style="font-size: 14px; color: #999">Counseling</a> <a href="/tags/Cryptography/" style="font-size: 14px; color: #999">Cryptography</a> <a href="/tags/D-Drayton/" style="font-size: 14px; color: #999">D.Drayton</a> <a href="/tags/Deep-Learning/" style="font-size: 14px; color: #999">Deep Learning</a> <a href="/tags/Depth-first-Search/" style="font-size: 14px; color: #999">Depth-first Search</a> <a href="/tags/DigitCircuit/" style="font-size: 14px; color: #999">DigitCircuit</a> <a href="/tags/E-Vere/" style="font-size: 14px; color: #999">E. Vere</a> <a href="/tags/E-Spencer/" style="font-size: 14px; color: #999">E.Spencer</a> <a href="/tags/Essay/" style="font-size: 14.37px; color: #969696">Essay</a> <a href="/tags/Github/" style="font-size: 14.74px; color: #949494">Github</a> <a href="/tags/GoldenTreasury/" style="font-size: 23.26px; color: #5a5a5a">GoldenTreasury</a> <a href="/tags/H-Constable/" style="font-size: 14px; color: #999">H.Constable</a> <a href="/tags/J-Donne/" style="font-size: 14px; color: #999">J.Donne</a> <a href="/tags/J-Lyly/" style="font-size: 14px; color: #999">J.Lyly</a> <a href="/tags/J-Sylvester/" style="font-size: 14px; color: #999">J.Sylvester</a> <a href="/tags/J-Webster/" style="font-size: 14px; color: #999">J.Webster</a> <a href="/tags/Leetcode/" style="font-size: 24px; color: #555">Leetcode</a> <a href="/tags/Leetcode-Contest/" style="font-size: 23.63px; color: #585858">Leetcode Contest</a> <a href="/tags/Lyric/" style="font-size: 17.33px; color: #828282">Lyric</a> <a href="/tags/Machine-Learning/" style="font-size: 15.11px; color: #919191">Machine Learning</a> <a href="/tags/Machine-Translation/" style="font-size: 16.59px; color: #878787">Machine Translation</a> <a href="/tags/Natural-Language-Processing/" style="font-size: 17.33px; color: #828282">Natural Language Processing</a> <a href="/tags/OS/" style="font-size: 21.78px; color: #646464">OS</a> <a href="/tags/OSTEP/" style="font-size: 18.07px; color: #7d7d7d">OSTEP</a> <a href="/tags/OldBlog/" style="font-size: 15.11px; color: #919191">OldBlog</a> <a href="/tags/P-Sidney/" style="font-size: 14px; color: #999">P.Sidney</a> <a href="/tags/Paper/" style="font-size: 16.59px; color: #878787">Paper</a> <a href="/tags/Paul-Simon/" style="font-size: 14px; color: #999">Paul Simon</a> <a href="/tags/PhysicsExperiment/" style="font-size: 14.37px; color: #969696">PhysicsExperiment</a> <a href="/tags/Psychology/" style="font-size: 14px; color: #999">Psychology</a> <a href="/tags/Quality-Estimation/" style="font-size: 15.48px; color: #8f8f8f">Quality Estimation</a> <a href="/tags/R-Barnfield/" style="font-size: 14px; color: #999">R.Barnfield</a> <a href="/tags/Raspberry-Pi/" style="font-size: 14px; color: #999">Raspberry Pi</a> <a href="/tags/Reading-Report/" style="font-size: 17.7px; color: #808080">Reading Report</a> <a href="/tags/S-Daniel/" style="font-size: 14px; color: #999">S.Daniel</a> <a href="/tags/SGU/" style="font-size: 14.37px; color: #969696">SGU</a> <a href="/tags/Sonnet/" style="font-size: 20.67px; color: #6c6c6c">Sonnet</a> <a href="/tags/Spokes/" style="font-size: 14.74px; color: #949494">Spokes</a> <a href="/tags/SystemAnalysis-Control/" style="font-size: 14px; color: #999">SystemAnalysis&Control</a> <a href="/tags/T-Dekker/" style="font-size: 14px; color: #999">T.Dekker</a> <a href="/tags/T-Heywood/" style="font-size: 14px; color: #999">T.Heywood</a> <a href="/tags/T-Lodge/" style="font-size: 14px; color: #999">T.Lodge</a> <a href="/tags/T-Nashe/" style="font-size: 14px; color: #999">T.Nashe</a> <a href="/tags/T-Wyatt/" style="font-size: 14px; color: #999">T.Wyatt</a> <a href="/tags/THUMT/" style="font-size: 14.37px; color: #969696">THUMT</a> <a href="/tags/TensorFlow/" style="font-size: 15.11px; color: #919191">TensorFlow</a> <a href="/tags/Translation/" style="font-size: 18.44px; color: #7b7b7b">Translation</a> <a href="/tags/Tree/" style="font-size: 14px; color: #999">Tree</a> <a href="/tags/USACO/" style="font-size: 22.52px; color: #5f5f5f">USACO</a> <a href="/tags/W-Alexander/" style="font-size: 14px; color: #999">W.Alexander</a> <a href="/tags/W-Drummond/" style="font-size: 15.11px; color: #919191">W.Drummond</a> <a href="/tags/W-Shakespeare/" style="font-size: 22.15px; color: #626262">W.Shakespeare</a> <a href="/tags/object-Object/" style="font-size: 14px; color: #999">[object Object]</a> <a href="/tags/alg-Array/" style="font-size: 21.04px; color: #696969">alg:Array</a> <a href="/tags/alg-Automata/" style="font-size: 14px; color: #999">alg:Automata</a> <a href="/tags/alg-Backtracking/" style="font-size: 15.85px; color: #8c8c8c">alg:Backtracking</a> <a href="/tags/alg-Binary-Indexed-Tree/" style="font-size: 14px; color: #999">alg:Binary Indexed Tree</a> <a href="/tags/alg-Binary-Search/" style="font-size: 15.48px; color: #8f8f8f">alg:Binary Search</a> <a href="/tags/alg-Binary-Search-Tree/" style="font-size: 16.59px; color: #878787">alg:Binary Search Tree</a> <a href="/tags/alg-Binray-Search/" style="font-size: 14px; color: #999">alg:Binray Search</a> <a href="/tags/alg-Bit-Manipulation/" style="font-size: 15.48px; color: #8f8f8f">alg:Bit Manipulation</a> <a href="/tags/alg-Bitmasks/" style="font-size: 14px; color: #999">alg:Bitmasks</a> <a href="/tags/alg-Breadth-first-Search/" style="font-size: 17.33px; color: #828282">alg:Breadth-first Search</a> <a href="/tags/alg-Breadth-firth-Search/" style="font-size: 14.37px; color: #969696">alg:Breadth-firth Search</a> <a href="/tags/alg-Brute-Force/" style="font-size: 16.96px; color: #858585">alg:Brute Force</a> <a href="/tags/alg-Centroid-Decomposition/" style="font-size: 14px; color: #999">alg:Centroid Decomposition</a> <a href="/tags/alg-Depth-first-Search/" style="font-size: 20.3px; color: #6e6e6e">alg:Depth-first Search</a> <a href="/tags/alg-Divide-and-Conquer/" style="font-size: 14px; color: #999">alg:Divide and Conquer</a> <a href="/tags/alg-Dynamic-Porgramming/" style="font-size: 14px; color: #999">alg:Dynamic Porgramming</a> <a href="/tags/alg-Dynamic-Programming/" style="font-size: 21.04px; color: #696969">alg:Dynamic Programming</a> <a href="/tags/alg-Games/" style="font-size: 14px; color: #999">alg:Games</a> <a href="/tags/alg-Geometry/" style="font-size: 14px; color: #999">alg:Geometry</a> <a href="/tags/alg-Graph/" style="font-size: 15.48px; color: #8f8f8f">alg:Graph</a> <a href="/tags/alg-Greedy/" style="font-size: 21.41px; color: #676767">alg:Greedy</a> <a href="/tags/alg-Hash-Table/" style="font-size: 20.67px; color: #6c6c6c">alg:Hash Table</a> <a href="/tags/alg-Heap/" style="font-size: 15.11px; color: #919191">alg:Heap</a> <a href="/tags/alg-In-Order-Traversal/" style="font-size: 14.37px; color: #969696">alg:In-Order Traversal</a> <a href="/tags/alg-Linked-List/" style="font-size: 15.48px; color: #8f8f8f">alg:Linked List</a> <a href="/tags/alg-Math/" style="font-size: 22.89px; color: #5d5d5d">alg:Math</a> <a href="/tags/alg-Matrix/" style="font-size: 14px; color: #999">alg:Matrix</a> <a href="/tags/alg-Meet-in-the-Middle/" style="font-size: 14.37px; color: #969696">alg:Meet in the Middle</a> <a href="/tags/alg-Minimax/" style="font-size: 14px; color: #999">alg:Minimax</a> <a href="/tags/alg-Monotonic-Stack/" style="font-size: 15.48px; color: #8f8f8f">alg:Monotonic Stack</a> <a href="/tags/alg-Priority-Queue/" style="font-size: 14px; color: #999">alg:Priority Queue</a> <a href="/tags/alg-Queue/" style="font-size: 14.74px; color: #949494">alg:Queue</a> <a href="/tags/alg-Random/" style="font-size: 14.74px; color: #949494">alg:Random</a> <a href="/tags/alg-Recursion/" style="font-size: 15.48px; color: #8f8f8f">alg:Recursion</a> <a href="/tags/alg-Recursive/" style="font-size: 14.37px; color: #969696">alg:Recursive</a> <a href="/tags/alg-Rejection-Sampling/" style="font-size: 14px; color: #999">alg:Rejection Sampling</a> <a href="/tags/alg-Reservoir-Sampling/" style="font-size: 14px; color: #999">alg:Reservoir Sampling</a> <a href="/tags/alg-Segmentation-Tree/" style="font-size: 14px; color: #999">alg:Segmentation Tree</a> <a href="/tags/alg-Set/" style="font-size: 14px; color: #999">alg:Set</a> <a href="/tags/alg-Sort/" style="font-size: 14.74px; color: #949494">alg:Sort</a> <a href="/tags/alg-Stack/" style="font-size: 18.44px; color: #7b7b7b">alg:Stack</a> <a href="/tags/alg-String/" style="font-size: 18.81px; color: #787878">alg:String</a> <a href="/tags/alg-Topological-Sort/" style="font-size: 14px; color: #999">alg:Topological Sort</a> <a href="/tags/alg-Tree/" style="font-size: 19.93px; color: #717171">alg:Tree</a> <a href="/tags/alg-Trie/" style="font-size: 14px; color: #999">alg:Trie</a> <a href="/tags/alg-Two-Pointers/" style="font-size: 18.07px; color: #7d7d7d">alg:Two Pointers</a> <a href="/tags/alg-Union-find-Forest/" style="font-size: 15.48px; color: #8f8f8f">alg:Union-find Forest</a> <a href="/tags/artist-Ceremony/" style="font-size: 14px; color: #999">artist:Ceremony</a> <a href="/tags/artist-Cruel-Hand/" style="font-size: 14.37px; color: #969696">artist:Cruel Hand</a> <a href="/tags/artist-Have-Heart/" style="font-size: 14px; color: #999">artist:Have Heart</a> <a href="/tags/artist-Johnny-Cash/" style="font-size: 14px; color: #999">artist:Johnny Cash</a> <a href="/tags/artist-Touche-Amore/" style="font-size: 14px; color: #999">artist:Touche Amore</a> <a href="/tags/artist-Wir-Sind-Helden/" style="font-size: 14.74px; color: #949494">artist:Wir Sind Helden</a> <a href="/tags/translation/" style="font-size: 14px; color: #999">translation</a> <a href="/tags/ucore/" style="font-size: 14px; color: #999">ucore</a> <a href="/tags/付勇林/" style="font-size: 15.85px; color: #8c8c8c">付勇林</a> <a href="/tags/卞之琳/" style="font-size: 14px; color: #999">卞之琳</a> <a href="/tags/屠岸/" style="font-size: 16.22px; color: #8a8a8a">屠岸</a> <a href="/tags/戴镏龄/" style="font-size: 15.85px; color: #8c8c8c">戴镏龄</a> <a href="/tags/曹明伦/" style="font-size: 15.48px; color: #8f8f8f">曹明伦</a> <a href="/tags/朱生豪/" style="font-size: 17.7px; color: #808080">朱生豪</a> <a href="/tags/李霁野/" style="font-size: 15.11px; color: #919191">李霁野</a> <a href="/tags/杨熙龄/" style="font-size: 14px; color: #999">杨熙龄</a> <a href="/tags/林天斗/" style="font-size: 14px; color: #999">林天斗</a> <a href="/tags/梁宗岱/" style="font-size: 16.96px; color: #858585">梁宗岱</a> <a href="/tags/梁葆成/" style="font-size: 14px; color: #999">梁葆成</a> <a href="/tags/袁广达/" style="font-size: 14px; color: #999">袁广达</a> <a href="/tags/郭沫若/" style="font-size: 14px; color: #999">郭沫若</a> <a href="/tags/黄新渠/" style="font-size: 14px; color: #999">黄新渠</a>
    </div>
  </section>


      
    
  
    
      
      
        <section class="list">
  
<header class="pure">
  <div><i class="fas fa-link fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;特别链接</div>
  
</header>

  <div class="content pure">
    <ul class="entry">
      
        <li><a class="flat-box" title="https://wenj.github.io/" href="https://wenj.github.io/">
          <div class="name">
            
              <i class="fas fa-comment-dots fa-fw" aria-hidden="true"></i>
            
            &nbsp;&nbsp;wenj
          </div>
          
        </a></li>
      
        <li><a class="flat-box" title="http://bellasong.site/" href="http://bellasong.site/">
          <div class="name">
            
              <i class="fas fa-comment-dots fa-fw" aria-hidden="true"></i>
            
            &nbsp;&nbsp;ssh
          </div>
          
        </a></li>
      
    </ul>
  </div>
</section>

      
    
  


        </aside>
        <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
    </div>
    <footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="mailto:zhanghuimeng1997@gmail.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external"></a>
        
      
        
          <a href="https://github.com/zhanghuimeng" class="social fab fa-github flat-btn" target="_blank" rel="external"></a>
        
      
        
          <a href="https://music.163.com/#/user/home?id=261028414" class="social fas fa-music flat-btn" target="_blank" rel="external"></a>
        
      
    </div>
  
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>本站使用 <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a> 作为主题，总访问量为 <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span> 次。
  </div>
</footer>

    <script>setLoadingBarProgress(80);</script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>


  
    <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
    <script type="text/javascript">
      $(function() {
        const $reveal = $('.reveal');
    		if ($reveal.length === 0) return;
    		const sr = ScrollReveal({ distance: 0 });
    		sr.reveal('.reveal');
      });
    </script>
  
  
    <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
    <script type="text/javascript">
      $(function() {
        Waves.attach('.flat-btn', ['waves-button']);
        Waves.attach('.float-btn', ['waves-button', 'waves-float']);
        Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
        Waves.attach('.flat-box', ['waves-block']);
        Waves.attach('.float-box', ['waves-block', 'waves-float']);
        Waves.attach('.waves-image');
        Waves.init();
      });
    </script>
  
  
    <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>
  
  
  


  
  
  
    
      
      
        <script type="text/javascript">
          (function(d, s) {
            var j, e = d.getElementsByTagName(s)[0];
            if (typeof LivereTower === 'function') { return; }
            j = d.createElement(s);
            j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
            j.async = true;
            e.parentNode.insertBefore(j, e);
          })(document, 'script');
        </script>
      
      
    
  
  
    <script src="/js/app.js"></script>
<script src="/js/search.js"></script>
  








    <script>setLoadingBarProgress(100);</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
